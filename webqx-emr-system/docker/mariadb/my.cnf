# MariaDB Configuration for OpenEMR
# Optimized for healthcare data and HIPAA compliance

[client]
default-character-set = utf8mb4

[mysql]
default-character-set = utf8mb4

[mysqld]
# Basic Settings
bind-address = 0.0.0.0
port = 3306
default-storage-engine = InnoDB
default-authentication-plugin = mysql_native_password

# Character Set
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
init-connect = 'SET NAMES utf8mb4'
init-connect = 'SET collation_connection = utf8mb4_unicode_ci'

# SQL Mode (OpenEMR Compatible)
sql-mode = STRICT_TRANS_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO

# Connection Settings
max-connections = 200
max-connect-errors = 1000
connect-timeout = 60
wait-timeout = 600
interactive-timeout = 600

# Memory Settings
innodb-buffer-pool-size = 512M
innodb-log-file-size = 256M
innodb-log-buffer-size = 16M
key-buffer-size = 32M
max-allowed-packet = 64M
table-open-cache = 400
sort-buffer-size = 2M
read-buffer-size = 2M
read-rnd-buffer-size = 8M
myisam-sort-buffer-size = 64M
thread-cache-size = 8
query-cache-size = 32M
tmp-table-size = 64M
max-heap-table-size = 64M

# InnoDB Settings
innodb-file-per-table = 1
innodb-flush-method = O_DIRECT
innodb-flush-log-at-trx-commit = 2
innodb-lock-wait-timeout = 120

# Logging
general-log = 0
slow-query-log = 1
slow-query-log-file = /var/log/mysql/slow.log
long-query-time = 2
log-queries-not-using-indexes = 0

# Binary Logging (for replication/backup)
log-bin = mysql-bin
binlog-format = ROW
expire-logs-days = 7
max-binlog-size = 100M

# Security
local-infile = 0

# OpenEMR Specific Settings
lower-case-table-names = 0
ft-min-word-len = 3
group-concat-max-len = 4096

[mysqldump]
quick
quote-names
max-allowed-packet = 64M

[mysql]
no-auto-rehash

[myisamchk]
key-buffer-size = 32M
sort-buffer-size = 20M
read-buffer = 2M
write-buffer = 2M

[mysqlhotcopy]
interactive-timeout